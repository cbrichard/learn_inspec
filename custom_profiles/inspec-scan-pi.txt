Profile: DevSec Linux Security Baseline (linux-baseline)
Version: 2.2.0
Target:  ssh://kiri@pi:22

  ✔  os-01: Trusted hosts login
     ✔  File /etc/hosts.equiv should not exist
  ✔  os-02: Check owner and permissions for /etc/shadow
     ✔  File /etc/shadow should exist
     ✔  File /etc/shadow should be file
     ✔  File /etc/shadow should be owned by "root"
     ✔  File /etc/shadow should not be executable
     ✔  File /etc/shadow should not be readable by other
     ✔  File /etc/shadow group should eq "shadow"
     ✔  File /etc/shadow should be writable by owner
     ✔  File /etc/shadow should be readable by owner
     ✔  File /etc/shadow should be readable by group
  ✔  os-03: Check owner and permissions for /etc/passwd
     ✔  File /etc/passwd should exist
     ✔  File /etc/passwd should be file
     ✔  File /etc/passwd should be owned by "root"
     ✔  File /etc/passwd should not be executable
     ✔  File /etc/passwd should be writable by owner
     ✔  File /etc/passwd should not be writable by group
     ✔  File /etc/passwd should not be writable by other
     ✔  File /etc/passwd should be readable by owner
     ✔  File /etc/passwd should be readable by group
     ✔  File /etc/passwd should be readable by other
     ✔  File /etc/passwd group should eq "root"
  ✔  os-04: Dot in PATH variable
     ✔  Environment variable PATH split should not include ""
     ✔  Environment variable PATH split should not include "."
  ×  os-05: Check login.defs (4 failed)
     ✔  File /etc/login.defs should exist
     ✔  File /etc/login.defs should be file
     ✔  File /etc/login.defs should be owned by "root"
     ✔  File /etc/login.defs should not be executable
     ✔  File /etc/login.defs should be readable by owner
     ✔  File /etc/login.defs should be readable by group
     ✔  File /etc/login.defs should be readable by other
     ✔  File /etc/login.defs group should eq "root"
     ✔  login.defs ENV_SUPATH should include "/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
     ×  login.defs ENV_PATH should include "/usr/local/bin:/usr/bin:/bin"
     expected "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games" to include "/usr/local/bin:/usr/bin:/bin"
     ×  login.defs UMASK should include "027"
     expected "022" to include "027"
     ×  login.defs PASS_MAX_DAYS should eq "60"

     expected: "60"
          got: "99999"

     (compared using ==)

     ×  login.defs PASS_MIN_DAYS should eq "7"

     expected: "7"
          got: "0"

     (compared using ==)

     ✔  login.defs PASS_WARN_AGE should eq "7"
     ✔  login.defs LOGIN_RETRIES should eq "5"
     ✔  login.defs LOGIN_TIMEOUT should eq "60"
     ✔  login.defs UID_MIN should eq "1000"
     ✔  login.defs GID_MIN should eq "1000"
  ↺  os-05b: Check login.defs - RedHat specific
     ↺  Skipped control due to only_if condition.
  ×  os-06: Check for SUID/ SGID blacklist (expected `["/usr/bin/dotlockfile"].empty?` to return true, got false)
     ×  suid_check diff should be empty
     expected `["/usr/bin/dotlockfile"].empty?` to return true, got false
  ✔  os-07: Unique uid and gid
     ✔  /etc/passwd uids should not contain duplicates
     ✔  /etc/group gids should not contain duplicates
  ✔  os-08: Entropy
     ✔  2732 should >= 1000
  ✔  os-09: Check for .rhosts and .netrc file
     ✔  [] should be empty
  ×  os-10: CIS: Disable unused filesystems (8 failed)
     ×  File /etc/modprobe.d/dev-sec.conf content should match "install cramfs /bin/true"
     expected nil to match "install cramfs /bin/true"
     ×  File /etc/modprobe.d/dev-sec.conf content should match "install freevxfs /bin/true"
     expected nil to match "install freevxfs /bin/true"
     ×  File /etc/modprobe.d/dev-sec.conf content should match "install jffs2 /bin/true"
     expected nil to match "install jffs2 /bin/true"
     ×  File /etc/modprobe.d/dev-sec.conf content should match "install hfs /bin/true"
     expected nil to match "install hfs /bin/true"
     ×  File /etc/modprobe.d/dev-sec.conf content should match "install hfsplus /bin/true"
     expected nil to match "install hfsplus /bin/true"
     ×  File /etc/modprobe.d/dev-sec.conf content should match "install squashfs /bin/true"
     expected nil to match "install squashfs /bin/true"
     ×  File /etc/modprobe.d/dev-sec.conf content should match "install udf /bin/true"
     expected nil to match "install udf /bin/true"
     ×  File /etc/modprobe.d/dev-sec.conf content should match "install vfat /bin/true"
     expected nil to match "install vfat /bin/true"
  ✔  os-11: Protect log-directory
     ✔  File /var/log should be directory
     ✔  File /var/log should be owned by "root"
     ✔  File /var/log should be grouped into "root"
  ✔  package-01: Do not run deprecated inetd or xinetd
     ✔  System Package inetd should not be installed
     ✔  System Package xinetd should not be installed
  ✔  package-02: Do not install Telnet server
     ✔  System Package telnetd should not be installed
  ✔  package-03: Do not install rsh server
     ✔  System Package telnetd should not be installed
  ✔  package-05: Do not install ypserv server (NIS)
     ✔  System Package ypserv should not be installed
  ✔  package-06: Do not install tftp server
     ✔  System Package tftp-server should not be installed
  ✔  package-07: Install syslog server package
     ✔  System Package rsyslog should be installed
  ×  package-08: Install auditd (12 failed)
     ×  System Package auditd should be installed
     expected that `System Package auditd` is installed
     ×  Audit Daemon Config log_file should cmp == "/var/log/audit/audit.log"

     expected: "/var/log/audit/audit.log"
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config log_format should cmp == "raw"

     expected: "raw"
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config flush should match /^INCREMENTAL|INCREMENTAL_ASYNC$/
     expected nil to match /^INCREMENTAL|INCREMENTAL_ASYNC$/
     ×  Audit Daemon Config max_log_file_action should cmp == "keep_logs"

     expected: "keep_logs"
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config space_left should cmp == 75

     expected: 75
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config action_mail_acct should cmp == "root"

     expected: "root"
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config space_left_action should cmp == "SYSLOG"

     expected: "SYSLOG"
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config admin_space_left should cmp == 50

     expected: 50
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config admin_space_left_action should cmp == "SUSPEND"

     expected: "SUSPEND"
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config disk_full_action should cmp == "SUSPEND"

     expected: "SUSPEND"
          got:

     (compared using `cmp` matcher)

     ×  Audit Daemon Config disk_error_action should cmp == "SUSPEND"

     expected: "SUSPEND"
          got:

     (compared using `cmp` matcher)

  ✔  package-09: CIS: Additional process hardening
     ✔  System Package prelink should not be installed
  ↺  sysctl-01: IPv4 Forwarding
     ↺  Skipped control due to only_if condition.
  ×  sysctl-02: Reverse path filtering (2 failed)
     ×  Kernel Parameter net.ipv4.conf.all.rp_filter value should eq 1

     expected: 1
          got: 0

     (compared using ==)

     ×  Kernel Parameter net.ipv4.conf.default.rp_filter value should eq 1

     expected: 1
          got: 0

     (compared using ==)

  ✔  sysctl-03: ICMP ignore bogus error responses
     ✔  Kernel Parameter net.ipv4.icmp_ignore_bogus_error_responses value should eq 1
  ✔  sysctl-04: ICMP echo ignore broadcasts
     ✔  Kernel Parameter net.ipv4.icmp_echo_ignore_broadcasts value should eq 1
  ×  sysctl-05: ICMP ratelimit (
     expected: 100
          got: 1000

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv4.icmp_ratelimit value should eq 100

     expected: 100
          got: 1000

     (compared using ==)

  ×  sysctl-06: ICMP ratemask (
     expected: 88089
          got: 6168

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv4.icmp_ratemask value should eq 88089

     expected: 88089
          got: 6168

     (compared using ==)

  ×  sysctl-07: TCP timestamps (
     expected: 0
          got: 1

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv4.tcp_timestamps value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-08: ARP ignore (
     expected: 1
          got: 0

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv4.conf.all.arp_ignore value should eq 1

     expected: 1
          got: 0

     (compared using ==)

  ×  sysctl-09: ARP announce (
     expected: 2
          got: 0

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv4.conf.all.arp_announce value should eq 2

     expected: 2
          got: 0

     (compared using ==)

  ×  sysctl-10: TCP RFC1337 Protect Against TCP Time-Wait (
     expected: 1
          got: 0

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv4.tcp_rfc1337 value should eq 1

     expected: 1
          got: 0

     (compared using ==)

  ✔  sysctl-11: Protection against SYN flood attacks
     ✔  Kernel Parameter net.ipv4.tcp_syncookies value should eq 1
  ✔  sysctl-12: Shared Media IP Architecture
     ✔  Kernel Parameter net.ipv4.conf.all.shared_media value should eq 1
     ✔  Kernel Parameter net.ipv4.conf.default.shared_media value should eq 1
  ×  sysctl-13: Disable Source Routing (1 failed)
     ✔  Kernel Parameter net.ipv4.conf.all.accept_source_route value should eq 0
     ×  Kernel Parameter net.ipv4.conf.default.accept_source_route value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-14: Disable acceptance of all IPv4 redirected packets (2 failed)
     ×  Kernel Parameter net.ipv4.conf.default.accept_redirects value should eq 0

     expected: 0
          got: 1

     (compared using ==)

     ×  Kernel Parameter net.ipv4.conf.all.accept_redirects value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-15: Disable acceptance of all secure redirected packets (2 failed)
     ×  Kernel Parameter net.ipv4.conf.all.secure_redirects value should eq 0

     expected: 0
          got: 1

     (compared using ==)

     ×  Kernel Parameter net.ipv4.conf.default.secure_redirects value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-16: Disable sending of redirects packets (2 failed)
     ×  Kernel Parameter net.ipv4.conf.default.send_redirects value should eq 0

     expected: 0
          got: 1

     (compared using ==)

     ×  Kernel Parameter net.ipv4.conf.all.send_redirects value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-17: Disable log martians (2 failed)
     ×  Kernel Parameter net.ipv4.conf.all.log_martians value should eq 1

     expected: 1
          got: 0

     (compared using ==)

     ×  Kernel Parameter net.ipv4.conf.default.log_martians value should eq 1

     expected: 1
          got: 0

     (compared using ==)

  ×  sysctl-18: Disable IPv6 if it is not needed (
     expected: 1
          got: 0

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv6.conf.all.disable_ipv6 value should eq 1

     expected: 1
          got: 0

     (compared using ==)

  ✔  sysctl-19: IPv6 Forwarding
     ✔  Kernel Parameter net.ipv6.conf.all.forwarding value should eq 0
  ×  sysctl-20: Disable acceptance of all IPv6 redirected packets (2 failed)
     ×  Kernel Parameter net.ipv6.conf.default.accept_redirects value should eq 0

     expected: 0
          got: 1

     (compared using ==)

     ×  Kernel Parameter net.ipv6.conf.all.accept_redirects value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-21: Disable acceptance of IPv6 router solicitations messages (
     expected: 0
          got: "-1"

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv6.conf.default.router_solicitations value should eq 0

     expected: 0
          got: "-1"

     (compared using ==)

  ×  sysctl-22: Disable Accept Router Preference from router advertisement (
     expected: 0
          got: 1

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv6.conf.default.accept_ra_rtr_pref value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-23: Disable learning Prefix Information from router advertisement (
     expected: 0
          got: 1

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv6.conf.default.accept_ra_pinfo value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-24: Disable learning Hop limit from router advertisement (
     expected: 0
          got: 1

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv6.conf.default.accept_ra_defrtr value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-25: Disable the system`s acceptance of router advertisement (2 failed)
     ×  Kernel Parameter net.ipv6.conf.all.accept_ra value should eq 0

     expected: 0
          got: 1

     (compared using ==)

     ×  Kernel Parameter net.ipv6.conf.default.accept_ra value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-26: Disable IPv6 autoconfiguration (
     expected: 0
          got: 1

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv6.conf.default.autoconf value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-27: Disable neighbor solicitations to send out per address (
     expected: 0
          got: 1

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv6.conf.default.dad_transmits value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ×  sysctl-28: Assign one global unicast IPv6 addresses to each interface (
     expected: 1
          got: 16

     (compared using ==)
     )
     ×  Kernel Parameter net.ipv6.conf.default.max_addresses value should eq 1

     expected: 1
          got: 16

     (compared using ==)

  ✔  sysctl-29: Disable loading kernel modules
     ✔  Kernel Parameter kernel.modules_disabled value should eq 0
  ×  sysctl-30: Magic SysRq (
     expected: 0
          got: 1

     (compared using ==)
     )
     ×  Kernel Parameter kernel.sysrq value should eq 0

     expected: 0
          got: 1

     (compared using ==)

  ✔  sysctl-31a: Secure Core Dumps - dump settings
     ✔  Kernel Parameter fs.suid_dumpable value should cmp == /(0|2)/
  ↺  sysctl-31b: Secure Core Dumps - dump path
     ↺  Skipped control due to only_if condition.
  ✔  sysctl-32: kernel.randomize_va_space
     ✔  Kernel Parameter kernel.randomize_va_space value should eq 2
  ×  sysctl-33: CPU No execution Flag or Kernel ExecShield (2 failed)
     ×  /proc/cpuinfo Flags should include NX
     expected [] to include "nx"
     ×  Kernel Parameter kernel.exec-shield value should eq 1

     expected: 1
          got: nil

     (compared using ==)


Profile Summary: 23 successful controls, 28 control failures, 3 controls skipped
Test Summary: 62 successful, 57 failures, 3 skipped
